
\section{Coulomb Integrals with error function Operator}

In a lot of applications it's useful to modify the normal Coulomb operator with 
error function:
\begin{equation}\label{erf_coulomb_integral:1}
 \frac{1}{r_{12}} = \frac{erf(\omega r_{12})}{r_{12}} + \frac{erfc(\omega r_{12})}{r_{12}}
\end{equation}
where the error function is:
\begin{align}\label{erf_coulomb_integral:2}
 erf(\omega r_{12})  &= \frac{2}{\sqrt{\pi}}\int_{0}^{r_{12}} e^{-\omega t^{2}} dt \nonumber \\ 
 erfc(\omega r_{12}) &= \frac{2}{\sqrt{\pi}}\int_{r_{12}}^{+\infty} e^{-\omega t^{2}} dt
\end{align}
therefore $erf(\omega r_{12}) + erfc(\omega r_{12}) = 1$. $\omega$ is some given positive
constant. Based on the decomposition of the Coulomb operator, now the normal four body 
integral could be rewritten as:
\begin{equation}\label{erf_coulomb_integral:3}
 I_{ijkl} = \int \chi_{i}(r_{1})\chi_{j}(r_{1})\frac{erf(\omega r_{12})}{r_{12}}
\chi_{k}(r_{2})\chi_{l}(r_{2}) dr_{1} dr_{2}
\end{equation}

How to integrate the $I_{ijkl}$? By following the idea in \ref{os_eri}, we need to transform
the operator with erf or erfc function into another form, just like we use Laplace transformation
for the $r_{12}$ operator:
\begin{equation}\label{erf_coulomb_integral:5}
 \frac{1}{|r-r^{'}|} = \frac{2}{\pi^{1/2}}\int^{\infty}_{0}
e^{(r-r^{'})^{2}u^{2}}du
\end{equation}
in \ref{os_eri}. However, here we have a better idea; just to rewrite the normal erf/erfc function
in the following way:
\begin{align}\label{erf_coulomb_integral:4}
 erf(\omega r_{12})  
 &= \frac{2}{\sqrt{\pi}}\int_{0}^{r_{12}} e^{-\omega t^{2}} dt \quad \text{set t=u*r12}
 \Rightarrow \nonumber \\ 
 &= \frac{2}{\sqrt{\pi}}\int_{0}^{r_{12}} e^{-\omega (ur_{12})^{2}} d(ur_{12}) \nonumber \\
 &= \frac{2}{\sqrt{\pi}}\int_{0}^{1} r_{12}e^{-\omega u^{2}r_{12}^{2}} du 
\end{align}
here the trick is to use variable $u$ to replace the variable $t$, so that to transform the 
integral limit from $r_{12}$ to 1. By using this form of erf function, we can get:
\begin{equation}\label{erf_coulomb_integral:6}
 \frac{erf(\omega r_{12})}{r_{12}} = 
 \frac{2}{\sqrt{\pi}}\int_{0}^{1} e^{-\omega u^{2}r_{12}^{2}} du 
\end{equation}
so the $r_{12}$ inside the integrate of \ref{erf_coulomb_integral:4} is canceled with the 
one in the denominator. It's interesting that the result in \ref{erf_coulomb_integral:6}
is same with operator transformation in \ref{erf_coulomb_integral:5}, except that here
the integration goes from 0 to 1 and in \ref{erf_coulomb_integral:5} it goes from 0 to 
$+\infty$. Similarly, the operator with erfc function is:
\begin{equation}\label{erf_coulomb_integral:7}
 \frac{erfc(\omega r_{12})}{r_{12}} = 
 \frac{2}{\sqrt{\pi}}\int_{1}^{+\infty} e^{-\omega u^{2}r_{12}^{2}} du 
\end{equation}

Such derivation leads to an important idea, that the integral with operator 
$\dfrac{erf(\omega r_{12})}{r_{12}}$ etc. can be used for the recurrence relation described
in \ref{os_eri} without any problem. For example, the result in \ref{OS_ERI_eq:2}
can be rewritten as for operator with erf function:
\begin{equation}
 \begin{split}
 (ab|cd) &= \frac{2}{\pi^{1/2}}\int^{1}_{0} du 
\int dr \int dr^{'} \chi_{a}(r)\chi_{b}(r) e^{(r-r^{'})^{2}u^{2}}
\chi_{c}(r^{'})\chi_{d}(r^{'}) \\
&= \frac{2}{\pi^{1/2}}\int^{1}_{0} du
\int dr^{'}\chi_{c}(r^{'})\chi_{d}(r^{'}) 
\left( \int dr  \chi_{a}(r)\chi_{b}(r) e^{(r-r^{'})^{2}u^{2}}\right) \\ 
&= \frac{2}{\pi^{1/2}}\int^{1}_{0} du
\int dr^{'}\chi_{c}(r^{'})\chi_{d}(r^{'})(a|0_{r^{'}}|b) \\
&= \frac{2}{\pi^{1/2}}\int^{1}_{0} du (ab|u|cd)
 \end{split}
\end{equation}
for the case when $\omega = 1$.
